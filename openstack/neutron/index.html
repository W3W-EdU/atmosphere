
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../cinder/">
      
      
        <link rel="next" href="../nova/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.4">
    
    
      
        <title>Neutron - Atmosphere</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#neutron" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Atmosphere" class="md-header__button md-logo" aria-label="Atmosphere" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Atmosphere
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Neutron
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Atmosphere" class="md-nav__button md-logo" aria-label="Atmosphere" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Atmosphere
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deployment
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/quick-start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy/production/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Production
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ingress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ingress
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitoring
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OpenStack
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            OpenStack
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cinder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cinder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Neutron
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Neutron
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hardware-acceleration" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware Acceleration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hardware Acceleration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mellanox-accelerated-switching-and-packet-processing-asap2" class="md-nav__link">
    <span class="md-ellipsis">
      Mellanox Accelerated Switching And Packet Processing (ASAP2)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mellanox Accelerated Switching And Packet Processing (ASAP2)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#open-vswitch-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Open vSwitch configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neutron-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Neutron configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ovn-with-dpdk-enabled-provider-and-internal-tunnel-network-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      OVN with DPDK enabled provider and internal tunnel network traffic
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nova/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nova
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../octavia/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Octavia
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hardware-acceleration" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware Acceleration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hardware Acceleration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mellanox-accelerated-switching-and-packet-processing-asap2" class="md-nav__link">
    <span class="md-ellipsis">
      Mellanox Accelerated Switching And Packet Processing (ASAP2)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mellanox Accelerated Switching And Packet Processing (ASAP2)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#open-vswitch-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Open vSwitch configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neutron-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Neutron configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ovn-with-dpdk-enabled-provider-and-internal-tunnel-network-traffic" class="md-nav__link">
    <span class="md-ellipsis">
      OVN with DPDK enabled provider and internal tunnel network traffic
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="neutron">Neutron</h1>
<h2 id="hardware-acceleration">Hardware Acceleration</h2>
<h3 id="mellanox-accelerated-switching-and-packet-processing-asap2">Mellanox Accelerated Switching And Packet Processing (ASAP2)</h3>
<p>Mellanox ASAP2 is a technology that enables the offloading of the Open vSwitch
datapath to the NIC. This offloading is done by the NIC's firmware, and is
transparent to the host.</p>
<p>Atmosphere uses the <a href="https://github.com/vexxhost/netoffload"><code>netoffload</code></a>
project which takes care of validating and preparing the host for SR-IOV.</p>
<p>It is recommended to follow the BIOS, Kernel &amp; NIC configuration steps documented
within the <a href="https://github.com/vexxhost/netoffload#bios-configuration"><code>netoffload</code></a>
project before getting started.</p>
<h4 id="open-vswitch-configuration">Open vSwitch configuration</h4>
<p>In order to enable hardware off-loading in Open vSwitch, you must make sure that
you deploy with the following configuration:</p>
<div class="highlight"><pre><span></span><code><span class="nt">openvswitch_helm_values</span><span class="p">:</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ovs_hw_offload</span><span class="p">:</span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<h4 id="neutron-configuration">Neutron configuration</h4>
<p>In order to enable hardware off-loading in Neutron, you can simply deploy it
with the following configuration and it will use
<a href="https://github.com/vexxhost/netoffload"><code>netoffload</code></a> to automatically
configure ASAP2.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you see an Init error when deploying Neutron, you may need to look at the
logs of the <code>netoffload</code> container to see what went wrong.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="nt">neutron_helm_values</span><span class="p">:</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">netoffload</span><span class="p">:</span>
<span class="w">      </span><span class="nt">asap2</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">dev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enp97s0f0</span>
<span class="w">          </span><span class="nt">vfs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
</code></pre></div>
<h2 id="ovn-with-dpdk-enabled-provider-and-internal-tunnel-network-traffic">OVN with DPDK enabled provider and internal tunnel network traffic</h2>
<p>To enable this configuration it is recommended to have the management interface separate
from the interfaces used with DPDK.  Additionally, you need to allocate enough 1g
huge memory pages for the interfaces and VMs' memory that will use this network. A
sample inventory with all the elements for DPDK enabled OVN configuration is below.
The example is using Mellanox NIC cards with the mlx5_core driver.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Add if manila or octavia VMs will be using the DPDK network</span>
<span class="nt">manila_flavor_extra_specs</span><span class="p">:</span>
<span class="w">  </span><span class="s">&quot;hw:vif_multiqueue_enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;true&#39;</span>
<span class="w">  </span><span class="s">&quot;hw:mem_page_size&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">large</span>

<span class="nt">octavia_amphora_flavor_extra_specs</span><span class="p">:</span>
<span class="w">  </span><span class="s">&quot;hw:vif_multiqueue_enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;true&#39;</span>
<span class="w">  </span><span class="s">&quot;hw:mem_page_size&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">large</span>

<span class="c1"># Here are some examples of internal and provider networks using the DPDK network</span>
<span class="nt">neutron_networks</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">mtu_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1500</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dpdk-network</span>
<span class="w">  </span><span class="nt">port_security_enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">provider_network_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vlan</span>
<span class="w">  </span><span class="nt">provider_segmentation_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">999</span>
<span class="w">  </span><span class="nt">provider_physical_network</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">external</span>
<span class="w">  </span><span class="nt">shared</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">subnets</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">allocation_pool_start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.1.2</span>
<span class="w">    </span><span class="nt">allocation_pool_end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.1.254</span>
<span class="w">    </span><span class="nt">cidr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.10/24</span>
<span class="w">    </span><span class="nt">dns_nameservers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8.8.8.8</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8.8.8.8</span>
<span class="w">    </span><span class="nt">enable_dhcp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">gateway_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.1.1</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dpdk-network-subnet</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">mtu_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internal</span>
<span class="w">  </span><span class="nt">port_security_enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">shared</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">subnets</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">allocation_pool_start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.77.2</span>
<span class="w">    </span><span class="nt">allocation_pool_end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.77.254</span>
<span class="w">    </span><span class="nt">cidr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.77.0/24</span>
<span class="w">    </span><span class="nt">dns_nameservers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.1.1.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.1.1.1</span>
<span class="w">    </span><span class="nt">enable_dhcp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">gateway_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.77.1</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internal-subnet</span>

<span class="c1"># Socket_memory, lcore_mask, and driver parameters are depending on the environment</span>
<span class="c1"># See this OpenvSwitch [doc](https://docs.openvswitch.org/en/latest/intro/install/dpdk/#setup-ovs)</span>
<span class="c1"># for more information about tuning OpenvSwitch</span>
<span class="nt">openvswitch_helm_values</span><span class="p">:</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ovs_dpdk</span><span class="p">:</span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">socket_memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2048</span>
<span class="w">      </span><span class="nt">hugepages_mountpath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev/hugepages</span>
<span class="w">      </span><span class="nt">vhostuser_socket_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vhostuser</span>
<span class="w">      </span><span class="nt">lcore_mask</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0x1</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mlx5_core</span>
<span class="w">      </span><span class="nt">vhost_iommu_support</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="c1"># In these values we are defining the provider interface the same as our internal</span>
<span class="c1"># tunnel interface.  It assumes that the primary interface is for tunnel traffic and</span>
<span class="c1"># provider networks via VLAN.</span>
<span class="nt">ovn_helm_values</span><span class="p">:</span>
<span class="w">  </span><span class="nt">network</span><span class="p">:</span>
<span class="w">    </span><span class="nt">interface</span><span class="p">:</span>
<span class="w">      </span><span class="nt">tunnel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">br-ex</span>
<span class="w">      </span><span class="nt">tunnel_network_cidr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.0/19</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ovn_bridge_mappings</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">external:br-ex</span>
<span class="w">    </span><span class="nt">ovn_bridge_datapath_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">netdev</span>

<span class="nt">neutron_helm_values</span><span class="p">:</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">neutron</span><span class="p">:</span>
<span class="w">      </span><span class="nt">DEFAULT</span><span class="p">:</span>
<span class="w">        </span><span class="nt">global_physnet_mtu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9100</span>
<span class="w">    </span><span class="nt">plugins</span><span class="p">:</span>
<span class="w">      </span><span class="nt">ml2_conf</span><span class="p">:</span>
<span class="w">        </span><span class="nt">ml2</span><span class="p">:</span>
<span class="w">          </span><span class="nt">path_mtu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9100</span>
<span class="w">          </span><span class="nt">physical_network_mtus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">external:9100</span>
<span class="w">        </span><span class="nt">ml2_type_vxlan</span><span class="p">:</span>
<span class="w">          </span><span class="nt">vni_ranges</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000:1000000</span>
<span class="w">    </span><span class="nt">ovs_dpdk</span><span class="p">:</span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">update_dpdk_bond_config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mlx5_core</span>
<span class="w">      </span><span class="nt">bonds</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dpdkbond</span>
<span class="w">          </span><span class="nt">bridge</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">br-ex</span>
<span class="w">          </span><span class="nt">migrate_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">          </span><span class="nt">mtu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9100</span>
<span class="w">          </span><span class="nt">n_rxq</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">          </span><span class="nt">n_txq</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">          </span><span class="nt">n_rxq_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2048</span>
<span class="w">          </span><span class="nt">n_txq_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2048</span>
<span class="w">          </span><span class="nt">vhost_iommu_support</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">          </span><span class="nt">ovs_options</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;bond_mode=balance-tcp</span><span class="nv"> </span><span class="s">lacp=active</span><span class="nv"> </span><span class="s">bond_updelay=10</span><span class="nv"> </span><span class="s">bond_downdelay=10</span><span class="nv"> </span><span class="s">other_config:lacp-time=fast&#39;</span>
<span class="w">          </span><span class="nt">nics</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dpdk_b0s0</span>
<span class="w">              </span><span class="nt">pci_id</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0000:c1:00.0&#39;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dpdk_b0s1</span>
<span class="w">              </span><span class="nt">pci_id</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0000:c1:00.1&#39;</span>
<span class="w">      </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dpdk</span>
<span class="w">          </span><span class="nt">log_level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">info</span>
<span class="w">      </span><span class="nt">nics</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>

<span class="c1"># for any flavors that need to use a DPDK enabled network the extra_specs are require.</span>
<span class="nt">nova_flavors</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">disk</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m1.tiny</span>
<span class="w">    </span><span class="nt">ram</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">512</span>
<span class="w">    </span><span class="nt">vcpus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">extra_specs</span><span class="p">:</span>
<span class="w">      </span><span class="s">&quot;hw:vif_multiqueue_enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;true&#39;</span>
<span class="w">      </span><span class="s">&quot;hw:mem_page_size&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;large&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">disk</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m1.small</span>
<span class="w">    </span><span class="nt">ram</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2048</span>
<span class="w">    </span><span class="nt">vcpus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">extra_specs</span><span class="p">:</span>
<span class="w">      </span><span class="s">&quot;hw:vif_multiqueue_enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;true&#39;</span>
<span class="w">      </span><span class="s">&quot;hw:mem_page_size&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;large&#39;</span>
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Atmosphere is a community effort led by <a href="https://vexxhost.com">VEXXHOST, Inc.</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.7389ff0e.min.js"></script>
      
    
  </body>
</html>